<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/assets/main.css">
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Albert Mata</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <a class="page-link" href="/">Home</a><a class="page-link" href="/notes/">Notes</a><a class="page-link" href="/skills/">Skills</a><a class="page-link" href="/resume/">Resume</a><a class="page-link" href="/privacy/">Privacy</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Basic introduction to pointers in C</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2012-10-22T00:00:00+02:00" itemprop="datePublished">Oct 22, 2012
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>For most Computer Science students, pointers in C is usually a complex subject to fully understand, when it really shouldn’t be, as long as it’s quite straightforward when it’s well explained. So that’s what this article tries to do.</p>

<h2 id="introduction">Introduction</h2>

<p>Put it short, a pointer is nothing else than a memory address. So, any time we talk about pointers we are actually talking about specific memory addresses where there are some contents we are interested in.</p>

<p>Let’s start with a very basic code where we just declare an integer variable <code class="language-plaintext highlighter-rouge">i</code>, assign a value to it and print some result in our standard output:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Our variable i has value %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Our variable i has value 42</span>
</code></pre></div></div>

<p>This variable is, of course, living in some specific place in our computer’s memory. That specific place is a memory address (so, a pointer) that we can actually find out using the <code class="language-plaintext highlighter-rouge">&amp;</code> operator:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Our variable i has value %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Our variable i lives in memory address %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Our variable i has value 42</span>
<span class="c1">// Our variable i lives in memory address 0x7fff55f18ba4</span>
</code></pre></div></div>

<p>Please note that while <code class="language-plaintext highlighter-rouge">%i</code> works to format an integer in <code class="language-plaintext highlighter-rouge">printf</code> function, <code class="language-plaintext highlighter-rouge">%p</code> is required to format a pointer.</p>

<p>Which type is that memory address value? Well, it’s a pointer, and more specifically it’s a pointer to an integer, because we know an integer is what’s being stored in that memory address. Although this explanation takes an integer example, it’s of course the same whatever data type we consider.</p>

<p>When we want to say “a pointer to something” we use a special notation <code class="language-plaintext highlighter-rouge">something*</code>. So, in our code we can write this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">pi</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Our variable i has value %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Our variable i lives in memory address %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Our pointer to integer pi has value %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">pi</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Our variable i has value 42</span>
<span class="c1">// Our variable i lives in memory address 0x7fff5f4b8ba4</span>
<span class="c1">// Our pointer to integer pi has value 0x7fff5f4b8ba4</span>
</code></pre></div></div>

<p>The expression <code class="language-plaintext highlighter-rouge">int* pi</code> can also be written as <code class="language-plaintext highlighter-rouge">int * pi</code> or as <code class="language-plaintext highlighter-rouge">int *pi</code>. It really doesn’t matter at all if the space is after the asterisk, before it or after and before. In all cases the type is <code class="language-plaintext highlighter-rouge">int*</code> (pointer to an integer).</p>

<h2 id="usage-of-pointers">Usage of pointers</h2>

<p>At this point we have a little space in memory where there is a value (42) and we also know the address of that little space in memory (0x7fff5f4b8ba4). Knowing this address will be helpful when we want to tell some other piece of code “hey, you probably want to set a value for an integer for me, just use this memory address for that and I’ll check the content later”.</p>

<p>Let’s see an example for this. Imagine we have an odd function that tells if a given number is even or not (returns 1 when it’s even, 0 otherwise) but at the same time it adds 10 to that given number when it’s even.</p>

<p>We could try to do it this way:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">isEven</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Initial value of i: %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">isEven</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Is i even (1 = yes, 0 = no): %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Final value of i: %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Initial value of i: 42</span>
<span class="c1">// Is i even (1 = yes, 0 = no): 1</span>
<span class="c1">// Final value of i: 42</span>
</code></pre></div></div>

<p>But it obviously doesn’t work because <code class="language-plaintext highlighter-rouge">isEven</code> function increments the value of a <code class="language-plaintext highlighter-rouge">i</code> variable whose scope is just that <code class="language-plaintext highlighter-rouge">isEven</code> function. It’s not changing the <code class="language-plaintext highlighter-rouge">i</code> variable in <code class="language-plaintext highlighter-rouge">main</code>. These two variables are actually in different memory addresses, as we could check easily:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">isEven</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory addres of i in isEven: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory addres of i in main: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Initial value of i: %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">isEven</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Is i even (1 = yes, 0 = no): %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Final value of i: %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Memory addres of i in main: 0x7fff53e7dba4</span>
<span class="c1">// Initial value of i: 42</span>
<span class="c1">// Memory addres of i in isEven: 0x7fff53e7db8c</span>
<span class="c1">// Is i even (1 = yes, 0 = no): 1</span>
<span class="c1">// Final value of i: 42</span>
</code></pre></div></div>

<p>So, as we said, in this situation we can use a pointer to an integer and tell <code class="language-plaintext highlighter-rouge">isEven</code> “hey, I know you maybe want to change the value for the integer I’m sending to you, if so put it in this memory address so that I can check it later”. In code:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">isEven</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">pi</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory addres of i in isEven: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">pi</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">pi</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">*</span><span class="n">pi</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory addres of i in main: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Initial value of i: %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">isEven</span><span class="p">(</span><span class="o">&amp;</span><span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Is i even (1 = yes, 0 = no): %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Final value of i: %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Memory addres of i in main: 0x7fff50dc6ba4</span>
<span class="c1">// Initial value of i: 42</span>
<span class="c1">// Memory addres of i in isEven: 0x7fff50dc6ba4</span>
<span class="c1">// Is i even (1 = yes, 0 = no): 1</span>
<span class="c1">// Final value of i: 52</span>
</code></pre></div></div>

<p>If we look at the output, we can see that <code class="language-plaintext highlighter-rouge">isEven</code> still returns the right value (a number 1, as 42 is even) but now it also changes the value for variable <code class="language-plaintext highlighter-rouge">i</code> as both <code class="language-plaintext highlighter-rouge">main</code> and <code class="language-plaintext highlighter-rouge">isEven</code> work with the value at the same memory address.</p>

<p>But, hey, we have a new syntax there. What does that asterisk in <code class="language-plaintext highlighter-rouge">*pi</code> mean inside the function? In some sense it’s the opposite to the <code class="language-plaintext highlighter-rouge">&amp;</code> operator, and we call it dereferencing. With <code class="language-plaintext highlighter-rouge">&amp;</code>, we get the memory address where a real value is stored. With <code class="language-plaintext highlighter-rouge">*</code>, we get access to the real value behind a memory address.</p>

<p>We actually could create a bizarre expression like this <code class="language-plaintext highlighter-rouge">*(&amp;(*(&amp;i)))</code> to say “get the real value behind the memory address of the real value behind the memory address where <code class="language-plaintext highlighter-rouge">i</code> lives”. And, of course, we’d get exactly the same as just writing <code class="language-plaintext highlighter-rouge">i</code>.</p>

<p>And we could also define something like <code class="language-plaintext highlighter-rouge">int ***pppi</code> which would read as “a pointer to a pointer to a pointer to an integer”. That would be a memory address where we store another memory address where we store another memory address where we store an integer value.</p>

<h2 id="pointers-and-arrays">Pointers and arrays</h2>

<p>There is a strong relationship between arrays and pointers. When we declare an array of N elements, we are taking a space in memory where N elements are to be stored contiguously. That is, in memory addresses one next to the other. For instance:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">42</span><span class="p">};</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Memory address for element %i: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Memory address for element 0: 0x7fff55b4cb90</span>
<span class="c1">// Memory address for element 1: 0x7fff55b4cb94</span>
<span class="c1">// Memory address for element 2: 0x7fff55b4cb98</span>
<span class="c1">// Memory address for element 3: 0x7fff55b4cb9c</span>
<span class="c1">// Memory address for element 4: 0x7fff55b4cba0</span>
<span class="c1">// Memory address for element 5: 0x7fff55b4cba4</span>
</code></pre></div></div>

<p>We can see that ~90, ~94, ~98, ~9c, ~a0 and ~a4 are contiguous memory addresses separated by 4 (because each integer in my machine is represented using 4 bytes). The memory address for the first element (<code class="language-plaintext highlighter-rouge">arr[0]</code>) can also be accessed simply as <code class="language-plaintext highlighter-rouge">arr</code> instead of <code class="language-plaintext highlighter-rouge">&amp;arr[0]</code>.</p>

<p>That said, we could set a pointer to an integer to store the memory address for the first element in the array (or, said in an easier way, just a pointer to the array):</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">42</span><span class="p">};</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">parr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory address for array's element 0: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory address for pointer to array: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">parr</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span> 

<span class="c1">// Memory address for array's element 0: 0x7fff5e84db90</span>
<span class="c1">// Memory address for pointer to array: 0x7fff5e84db90</span>
</code></pre></div></div>

<p>What’s interesting now is that as <code class="language-plaintext highlighter-rouge">parr</code> is a pointer to integers and the compiler knows that each integer is stored using 4 bytes, it’s possible to use it to access the elements of the array. For example we could get the memory address for the forth element in the array (so index 3, as arrays are zero based) just saying <code class="language-plaintext highlighter-rouge">parr + 3</code>. And we could change that value using the pointer:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">42</span><span class="p">};</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">parr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory address for array's element 0: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory address for pointer to array: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">parr</span><span class="p">);</span>
    <span class="o">*</span><span class="p">(</span><span class="n">parr</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1616</span><span class="p">;</span> <span class="c1">// it was 16</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory address for array's element 3: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Memory address for pointer to array's element 3: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">parr</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Real value for array's element 3 (using array): %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Real value for array's element 3 (using pointer): %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">parr</span> <span class="o">+</span> <span class="mi">3</span><span class="p">));</span>  
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Memory address for array's element 0: 0x7fff5078fb90</span>
<span class="c1">// Memory address for pointer to array: 0x7fff5078fb90</span>
<span class="c1">// Memory address for array's element 3: 0x7fff5078fb9c</span>
<span class="c1">// Memory address for pointer to array's element 3: 0x7fff5078fb9c</span>
<span class="c1">// Real value for array's element 3 (using array): 1616</span>
<span class="c1">// Real value for array's element 3 (using pointer): 1616</span>
</code></pre></div></div>

<p>This is possible only because <code class="language-plaintext highlighter-rouge">parr</code> is defined as <code class="language-plaintext highlighter-rouge">int*</code> and so when we say something like <code class="language-plaintext highlighter-rouge">parr + 1</code> the compiler knows it has to add 4 to <code class="language-plaintext highlighter-rouge">parr</code>’s memory address.</p>

<h2 id="pointers-to-functions">Pointers to functions</h2>

<p>The code for a function is also stored in some place in the memory (where else could it be?). So we actually could get the exact memory address where a function’s code starts. And we then could make use of that to pass a function (using that memory address, so that pointer) to another function that requires a function with the characteristics of the former. All this sounds worse than it actually is, so let’s see that with an example.</p>

<p>Imagine we have a function that gets an integer and firstly makes a lot of checks on it, secondly does some stuff with it (i.e. doubles it, or multiplies by itself, or negates its value, or whatever else) and finally returns if the final result is even or odd. The pseudocode could be as follows:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">isEven</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// lots of checks on i</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">do_stuff</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Of course this function could (and should) be organized differently, but let’s go with it for the sake of this example.</p>

<p>The problem now is that we actually don’t have a <code class="language-plaintext highlighter-rouge">do_stuff</code> function. What we have are some functions (<code class="language-plaintext highlighter-rouge">doubles</code>, <code class="language-plaintext highlighter-rouge">squares</code>, <code class="language-plaintext highlighter-rouge">negates</code> and so on) and we want that <code class="language-plaintext highlighter-rouge">isEven</code> uses the one we tell it to use and considers that as the stuff to do with the integer. Something like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">isEven</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">function</span> <span class="n">concrete_stuff_to_do</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// lots of checks on i</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">concrete_stuff_to_do</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>So it’s obvious that we need to pass a function as an argument to another function. That’s where function pointers are really useful. Let’s see how this works in real code:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">doubles</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// assuming it's still an int</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">squares</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// assuming it's still an int</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">negates</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">i</span><span class="p">;</span> <span class="c1">// assuming it's still an int</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">isEven</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="kt">int</span><span class="p">(</span><span class="o">*</span><span class="n">stuff_to_do</span><span class="p">)(</span><span class="kt">int</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// lots of checks on i</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">stuff_to_do</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">result</span><span class="p">;</span>

    <span class="c1">// doubles(3) isEven?</span>
    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">doubles_ptr</span><span class="p">)(</span><span class="kt">int</span><span class="p">);</span> <span class="c1">// declaring the function pointer</span>
    <span class="n">doubles_ptr</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">doubles</span><span class="p">;</span>  <span class="c1">// referencing to doubles function (the &amp; is optional)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">isEven</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">doubles_ptr</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"doubles(3) isEven? (1 = yes, 0 = no): %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>   

    <span class="c1">// squares(3) isEven?</span>
    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">squares_ptr</span><span class="p">)(</span><span class="kt">int</span><span class="p">);</span> <span class="c1">// declaring the function pointer</span>
    <span class="n">squares_ptr</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">squares</span><span class="p">;</span>  <span class="c1">// referencing to squares function (the &amp; is optional)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">isEven</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">squares_ptr</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"squares(3) isEven? (1 = yes, 0 = no): %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>   

    <span class="c1">// negates(3) isEven?</span>
    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">negates_ptr</span><span class="p">)(</span><span class="kt">int</span><span class="p">);</span> <span class="c1">// declaring the function pointer</span>
    <span class="n">negates_ptr</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">negates</span><span class="p">;</span>  <span class="c1">// referencing to negates function (the &amp; is optional)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">isEven</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">negates_ptr</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"negates(3) isEven? (1 = yes, 0 = no): %i</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>       

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// doubles(3) isEven? (1 = yes, 0 = no): 1</span>
<span class="c1">// squares(3) isEven? (1 = yes, 0 = no): 0</span>
<span class="c1">// negates(3) isEven? (1 = yes, 0 = no): 0</span>
</code></pre></div></div>

<p>There are some important things to notice. One of them is how we express a function pointer. This could be a very simple first example where we declare a pointer (named <code class="language-plaintext highlighter-rouge">foo</code>) to a function that takes an integer and returns nothing:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">foo</span><span class="p">)(</span><span class="kt">int</span><span class="p">);</span>
</code></pre></div></div>

<p>And this is another example where we declare a pointer (named <code class="language-plaintext highlighter-rouge">foo</code> again) to a function that takes a pointer to an integer and returns a pointer to a float:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">foo</span><span class="p">)(</span><span class="kt">int</span> <span class="o">*</span><span class="p">);</span>
</code></pre></div></div>

<p>That’s what we’ve done in the previous code for example at this point:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">doubles_ptr</span><span class="p">)(</span><span class="kt">int</span><span class="p">);</span> <span class="c1">// declaring the function pointer</span>
<span class="n">doubles_ptr</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">doubles</span><span class="p">;</span>  <span class="c1">// referencing to doubles function (the &amp; is optional)</span>
</code></pre></div></div>

<p>The second thing important in this code is how we tell a function to get another function as a parameter. For instance, in this example we have a function called <code class="language-plaintext highlighter-rouge">foo</code> that receives some standard parameters and a final parameter which is a pointer (called <code class="language-plaintext highlighter-rouge">bar</code>) to a function that takes a float and an integer and returns an integer:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="cm">/* some standard parameters here */</span><span class="p">,</span> <span class="kt">int</span><span class="p">(</span><span class="o">*</span><span class="n">bar</span><span class="p">)(</span><span class="kt">float</span><span class="p">,</span> <span class="kt">int</span><span class="p">));</span>
</code></pre></div></div>

<p>In the implementation of this <code class="language-plaintext highlighter-rouge">foo</code> function we could use the <code class="language-plaintext highlighter-rouge">bar</code> function the way we need, as long as we pass a float and integer to it (and we’ll get an integer as a result). That’s very similar to what we’ve done in our <code class="language-plaintext highlighter-rouge">isEven</code> function.</p>

<p>Of course function pointers have more interesting and useful uses, as setting up listener or callback functions to be invoked when a particular event happens. This example just tried to show how it works, not a real scenario where it should be used.</p>

  </div><a class="u-url" href="/2012/10/22/basic-introduction-to-pointers-in-c.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Email:</li>
          <li>hello <span class="footer-almost-black">at</span> albertmata <span class="footer-almost-black">dot</span> net</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/almata"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">almata</span></a></li><li><a href="https://www.linkedin.com/in/almata"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">almata</span></a></li><li><a href="https://www.twitter.com/almata"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">almata</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>
          This website does not use any cookie and does not collect any data. Read <a href="/privacy/">Privacy</a> for more information.
          Built with <a href="https://jekyllrb.com">Jekyll</a> and hosted on <a href="https://pages.github.com">GitHub Pages</a>.
          Maintained with ♥ for the web.
        </p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
